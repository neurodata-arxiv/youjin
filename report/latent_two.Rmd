---
title: "Hierarhical Models with Binary Latent Variable"
author: "Youjin Lee"
output: html_document
header-includes: 
  - \usepackage{tikz}
  - \usepackage{pgfplots}
---

- [Models](# Models)
- [two.1](# two.1)
- [two.2](# two.2)
- [two.3](# two.3)
- [two.4](# two.4)

```{r echo=FALSE, message =FALSE, warning = FALSE}
library(igraph)
library(RefManageR)
library(xtable)
library(grid)
library(ggplot2)
library(png)
library(grid)
library(knitr)
library(tikzDevice)
library(Matrix)
bib <- ReadBib(system.file("Bib", "biblatexExamples.bib", 
                           package = "RefManageR"), check = FALSE)
BibOptions(check.entries = FALSE, style = "markdown", bib.style = "alphabetic", cite.style = 'alphabetic')
```


## Models
<a name=" Models"/>

### Notations

- $A_{ij}$ = indicator variable of having edges between node $i$ and node $j$ on graph $G$.($i,j = 1,... , n$)

- $Z_{i}$ = $\{ k ; \mbox{ latent variable of block membership of node } i,  k = 1, ... , K \}$

- $X_{i}$ = Node attribute variable. 

Recall that what we want to test is independence between $A$ and $X$; since $A$ directly relates to the structure of network (graph) $G$, we assume that we are testing independence between $G$ and $X$.


### Two possible representations

  We have suggested two models as data generation schemes. 
  
  - [model 1] : $P( A | \color{red}{Z}) P(X | \color{red}{Z} ) P(Z)$
  
  - [model 2] : $P( A | \color{red}{Z}) P(\color{red}{Z} | X) P(X)$ 
  

[model 1] implies that a latent variable has an effect on both network structure $A$ and attribute variable $X$; while in [model 2], node attribute $X$ has its influence on $Z$ and $Z$ affects structure $A$. 


```{r, out.width = 300, out.height = 200, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/model1.png")
```
```{r, out.width = 300, out.height = 500, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/model2.png")
```

\bigskip
Actually, under the assumption below, two models are exactly the joint distribution of $(A, Z, X)$.

$$\mbox{Assumption 1 : A is independent of X conditional on Z}, i.e. A \perp X \big| Z.$$

[Figure 1] and [Figure 2] above illustrates causal diagram of both models. I assume that diagram of Figure 2 would be more appropriate to schematize the assumption - conditional independence - above. In [Figure 2], a latent variable $Z$ can also be interpreted as an effect modifier or mediator between $X$ and $A$; while in [Figure 1],a latent variable $Z$ acts like a confounder. For both models, $X$ and $A$ are both associated with $Z$, and we sometimes adjust for $Z$. If $Z$ is a mediator, it is on the causal pathway, and if $Z$ is an effect modifier, the association/correlation between $X$ and $A$ varies by levels of $Z$; while if $Z$ is a confounder, relationship between $X$ and $A$ is in part or wholly explained by the relationship between $Z$ and $A$. Contextually, we are more interested in explaining association between $X$ and $A$ stratified to $Z$, rather than controlling the effect of $Z$ in explaining relationship of $X$ and $A$.



- $Lemma$ : Both [Model 1] and [Model 2] are equivalent to joint distribution of $(A, Z, X)$ if $A \perp X \big| Z.$

Proof ) Under the assumption of $A \perp X \big| Z,$ 

$$\begin{align} P(A | Z, X) & = \frac{P(A, Z, X)}{P(Z,X)} \\ & = \frac{P(A, X | Z)P(Z) }{ P(Z,X)} \\ & = \frac{P(A | Z) P(X | Z) P(Z) }{ P(X | Z) P(Z) } \\ & = P(A |Z)   \end{align}$$

Thus, we can show the equivalence between $P(A | Z) P(X | Z) P(Z)$ and $P(A | Z) P(Z | X) P(X)$, and their equivalence to $P(A, Z, X).$

$$\begin{align} P(A | Z) P(X | Z) P(Z) & = P(A | Z) P(X , Z) = P(A | Z) P(Z | X) P(X) \\ & = P(A | Z , X) P(X , Z) \because A \perp X \big| Z \\ & = P(A, Z, X)   \end{align} \blacksquare.$$


For example, in binary latent case, it suffices to show that $P(X | Z)P(Z) = P(Z | X)P(X).$ Suppose $Z$ and $X | Z$ both follow Bernoulli distributon. 

$$Z \sim Bern(p)$$

$$X | Z \sim \left\{  \begin{array}{cc} Bern(q) & Z = 0  \\ Bern(r) & Z = 1 \end{array} \right.$$

Then the joint model of $(X,Z)$, marginal distribution of $X$, and conditional distribution of $Z | X$ are the following:

$$P(X | Z)P(Z) = \left( q^{x}(1-q)^{1-x} \right)^{1- z} \left( r^{x}(1-r)^{1-x} \right)^{z} p^{z}(1 - p)^{1-z}$$


$$\begin{align} P(X) & = \sum\limits_{z=0,1}P(X | Z = z)P(Z = z) \\ & = q^{x}(1 - q)^{x} (1-p) + r^{x}(1-r)^{1-x}p \\ & = \left( q (1-p)  + rp  \right)^{x} \left( (1-q)(1-p) + (1-r)p  \right)^{1-x} \end{align}$$

$$\begin{align} P(Z | X) & = \frac{\left( q^{x}(1-q)^{1-x} \right)^{1- z} \left( r^{x}(1-r)^{1-x} \right)^{z} p^{z}(1 - p)^{1-z}}{\left( q (1-p)  + rp  \right)^{x} \left( (1-q)(1-p) + (1-r)p  \right)^{1-x}} \\  & = \left( \frac{1}{q(1-p) + rp} \big( q(1-p)   \big)^{1-z} \big( rp \big)^{z}   \right)^{x} \left(\frac{1}{(1-q)(1-p) + (1-r)p} \big( (1-q)(1-p)  \big)^{1-z} \big( (1-r)p  \big)^{z}  \right)^{1-x}  \end{align}$$

Thus, we can conclude that :


$$X \sim Bern(q(1-p) + rp)$$

$$Z | X \sim \left\{  \begin{array}{cc} Bern(\frac{(1-r)p}{(1-q)(1-p) + (1-r)p } ) & X = 0  \\ Bern(\frac{rp}{q(1-p) + rp}) & X = 1 \end{array} \right.$$

For example if $(p,q,r) = (0.5, 0.6, 0.4),$

$$Z \sim Bern(0.5)$$

$$X | Z \sim \left\{  \begin{array}{cc} Bern(0.6) & Z = 0  \\ Bern(0.4) & Z = 1 \end{array} \right.$$

is equivalent to 

$$X \sim Bern(0.5)$$

$$Z | X \sim \left\{  \begin{array}{cc} Bern(0.6) & X = 0  \\ Bern(0.4) & X = 1 \end{array} \right.$$





 If $Z$ becomes nuisance, i.e., $X \rightarrow Z \rightarrow A$ is equivalent to $X \rightarrow A$, global test will beat any other local tests.  


### Simulation Model

Assume that group (block) membership is a function of $X$, i.e. $Z \sim f(X).$
Suppose that nodes having similar value of $x_{i}$ are more likely to be in the same membership $z_{i}.$ 

- Generate iid node attribute with a parameter $u$

$$X_{i} \overset{i.i.d}{\sim} Bern(u), i = 1,... , n$$

- Generate latent variables conditional on $X$ as a function of $\omega$

$$Z_{i}  | X_{i}  \overset{i.i.d}{\sim} Bern(0.5 - \omega (2 X_{i} - 1) )   =    \left\{  \begin{array}{cc} Bern(0.5 + \omega) & X_{i} = 0 \\ Bern(0.5 - \omega) & X_{i} = 1 \end{array} \right.$$

- Let $Z^{*}_{i} = Z_{i} + 1$ in binary case. Generate local dependent graph of $\phi = (p_{k}, q_{kl}; k,l = 1,...,K, k < l)$ : 

$$\begin{align} P_{\phi}(A = a | Z^{*} = z^{*}) & = \prod\limits_{k} P_{\phi}(A_{ij} = a_{ij} | Z^{*} = z^{*}) \times \prod\limits_{k < l} P_{\phi} (A_{kl} = a_{kl} | Z^{*} = z^{*}) \\ & = \prod\limits_{Z^{*}_{i} =  Z^{*}_{j} = k} {p_{k}}^{a_{ij}}(1-p_{k})^{a_{ij}} \prod\limits_{Z^{*}_{i} =k , Z^{*}_{j} = l} {q_{kl}}^{a_{ij}}(1 - q_{kl})^{a_{ij}} \end{align}$$.



Joint likelihood of $(A_{ij}, X_{i}, Z_{i} ; i,j=1,... ,n)$ can be illustrated:

$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z^{*}) P_{\omega}(Z | X) P_{u}(X) \\ & = \prod\limits_{Z^{*}_{i} = Z^{*}_{j} = k; k = 1}^{K} {p_{k}}^{a_{ij}}(1-p_{k})^{a_{ij}} \prod\limits_{Z^{*}_{i} =k,  Z^{*}_{j} = l ; k,l = 1, k < l}^{K} {q_{kl}}^{a_{ij}}(1 - q_{kl})^{a_{ij}} \\ & \times \prod\limits_{i=1}^{n} \left[ (0.5 - \omega(2X_{i} - 1))^{z_{i}} \big( 1 -  (0.5 - \omega(2X_{i} - 1))  \big)^{1 - z_{i}} u^{x_{i}} (1-u)^{1 - x_{i}} \right]  \end{align}$$





### [sim] two.1
<a name=" two.1"/>

$K = 2$; $n_{1} = n_{2} = 50$ ; $n = n_{1} + n_{2} = 100.$

```{r echo = FALSE, results='asis'}
a <- c(0.5, 0.0, 0.5, 0.5,  0.1)

table <- matrix(0, nrow = 1, ncol = 5)
colnames(table) <- c("u", "w" ,  "p1", "p1", "q12")
table[1,] <- a
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z) P_{\omega}(Z | X) P_{u}(X) \\ & = P_{\phi}( A | Z) P_{\omega}(Z) P_{u} (X) \\ & = \prod\limits_{Z_{i} = Z_{j} = 0}^{1} 0.5^{a_{ij}}(1-0.5)^{a_{ij}} \prod\limits_{Z_{i} \neq Z_{j} } 0.1^{a_{ij}}(1 - 0.1)^{a_{ij}} \prod\limits_{i=1}^{n}  (0.5)^{z_{i}} \big( 1 -  0.5)  \big)^{1 - z_{i}}  \prod\limits_{i=1}^{n} 0.5^{x_{i}} (1-0.5)^{1 - x_{i}} \end{align}$$

Since $X \perp Z$ and $X$ is correlated to $A$ only through $Z,$ $X \perp A.$



```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two1_power1.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two1_power10.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/two1_power20.png")
```


```{r echo = FALSE, results='asis'}
a <- c(0.05, 0.03, 0.06)
b <- c(0.10, 0.09, 0.10)

table <- matrix(0, nrow = 2, ncol = 3)
rownames(table) <- c("global test", "local optimal")
colnames(table) <- c("t=1",  "t=5", "t=20")
table[1,] <- a
table[2,] <- b
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```



```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center'}
knitr::include_graphics("../figure/two1_plot.png")
```


### [sim] two.2
<a name=" two.2"/>

$K = 2$; $n_{1} = n_{2} = 50$ ; $n = n_{1} + n_{2} = 100.$

```{r echo = FALSE, results='asis'}
a <- c(0.5, 0.1, 0.5, 0.5,  0.1)

table <- matrix(0, nrow = 1, ncol = 5)
colnames(table) <- c("u", "w", "p1", "p2", "q12")
table[1,] <- a
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z) P_{\omega}(Z | X) P_{u}(X) \\ & = \prod\limits_{Z_{i} = Z_{j} = 0}^{1} 0.5^{a_{ij}}(1-0.5)^{a_{ij}} \prod\limits_{Z_{i} \neq Z_{j} } 0.1^{a_{ij}}(1 - 0.1)^{a_{ij}}  \\ & \times  \prod\limits_{i=1}^{n} \left[ (0.6)^{z_{i}} ( 1 -  0.6)^{1 - z_{i}} I(x_{i} = 0) +  (0.4)^{z_{i}} \big( 1 -  0.4  \big)^{1 - z_{i}} I(x_{i} = 1) \right] \prod\limits_{i=1}^{n} 0.5^{x_{i}} (1-0.5)^{1 - x_{i}}   \end{align}$$


Now $\omega \neq 0,$ so $Z$ has correlation with $X.$ 


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two2_power1.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two2_power10.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/two2_power20.png")
```


```{r echo = FALSE, results='asis'}
a <- c(0.53, 0.54, 0.56)
b <- c(0.58, 0.59, 0.60)

table <- matrix(0, nrow = 2, ncol = 3)
rownames(table) <- c("global test", "local optimal")
colnames(table) <- c("t=1",  "t=5", "t=20")
table[1,] <- a
table[2,] <- b
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center'}
knitr::include_graphics("../figure/two2_plot.png")
```



### [sim] two.3
<a name=" two.3"/>

$K = 2$; $n_{1} = n_{2} = 50$ ; $n = n_{1} + n_{2} = 100.$

```{r echo = FALSE, results='asis'}
a <- c(0.5, 0.1, 0.3, 0.3, 0.3)

table <- matrix(0, nrow = 1, ncol = 5)
colnames(table) <- c("u", "w" , "p1", "p2", "q12")
table[1,] <- a
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z) P_{\omega}(Z | X) P_{u}(X) \\ & =  P_{\phi}(A) P_{\omega}(Z | X) P_{u}(X) \\ & = \prod\limits_{i,j=1}^{n} 0.3^{a_{ij}}(1-0.3)^{a_{ij}} \prod\limits_{i=1}^{n} \left[ (0.6)^{z_{i}} ( 1 -  0.6)^{1 - z_{i}} I(x_{i} = 0) +  (0.4)^{z_{i}} \big( 1 -  0.4  \big)^{1 - z_{i}} I(x_{i} = 1) \right] \prod\limits_{i=1}^{n} 0.5^{x_{i}} (1-0.5)^{1 - x_{i}}   \end{align}$$


Now we set $A \perp Z.$ Since $X$ can be related to $A$ only through $Z,$ $X \perp A.$


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two3_power1.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two3_power10.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/two3_power20.png")
```


```{r echo = FALSE, results='asis'}
a <- c(0.05, 0.05, 0.02)
b <- c(0.11, 0.12, 0.12)

table <- matrix(0, nrow = 2, ncol = 3)
rownames(table) <- c("global test", "local optimal")
colnames(table) <- c("t=1",  "t=5", "t=20")
table[1,] <- a
table[2,] <- b
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center'}
knitr::include_graphics("../figure/two3_plot.png")
```


### [sim] two.4
<a name=" two.4"/>

$K = 2$; $n_{1} = n_{2} = 50$ ; $n = n_{1} + n_{2} = 100.$

```{r echo = FALSE, results='asis'}
a <- c(0.5, 0.1, 0.5, 0.1, 0.1)

table <- matrix(0, nrow = 1, ncol = 5)
colnames(table) <- c("u", "w" , "p1", "p2", "q12")
table[1,] <- a
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z) P_{\omega}(Z | X) P_{u}(X) \\ & = \prod\limits_{Z_{i} = Z_{j} = 0} 0.5^{a_{ij}}(1-0.5)^{a_{ij}} \prod\limits_{Z_{i} = Z_{j} = 1} 0.1^{a_{ij}}(1-0.1)^{a_{ij}} \prod\limits_{Z_{i} \neq Z_{j}} 0.1^{a_{ij}}(1 - 0.1)^{a_{ij}}  \\ & \times  \prod\limits_{i=1}^{n} \left[ (0.6)^{z_{i}} ( 1 -  0.6)^{1 - z_{i}} I(x_{i} = 0) +  (0.4)^{z_{i}} \big( 1 -  0.4  \big)^{1 - z_{i}} I(x_{i} = 1) \right] \prod\limits_{i=1}^{n} 0.5^{x_{i}} (1-0.5)^{1 - x_{i}}   \end{align}$$

Now let $p_{2} = q_{12} < p_{1}$ so that only one block (about 50 $\%$ of tatal sample) has a higher probability. 


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two4_power1.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two4_power10.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/two4_power20.png")
```


```{r echo = FALSE, results='asis'}
a <- c(0.40, 0.34, 0.27)
b <- c(0.42, 0.38, 0.30)

table <- matrix(0, nrow = 2, ncol = 3)
rownames(table) <- c("global test", "local optimal")
colnames(table) <- c("t=1",  "t=5", "t=20")
table[1,] <- a
table[2,] <- b
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center'}
knitr::include_graphics("../figure/two4_plot.png")
```



### [sim] two.5
<a name=" two.5"/>

$K = 2$; $n_{1} = n_{2} = 50$ ; $n = n_{1} + n_{2} = 100.$

```{r echo = FALSE, results='asis'}
a <- c(0.5, 0.1, 0.5, 0.3, 0.1)

table <- matrix(0, nrow = 1, ncol = 5)
colnames(table) <- c("u", "w" , "p1", "p2", "q12")
table[1,] <- a
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z) P_{\omega}(Z | X) P_{u}(X) \\ & = \prod\limits_{Z_{i} = Z_{j} = 0} 0.5^{a_{ij}}(1-0.5)^{a_{ij}} \prod\limits_{Z_{i} = Z_{j} = 1} 0.3^{a_{ij}}(1-0.3)^{a_{ij}} \prod\limits_{Z_{i} \neq Z_{j}} 0.1^{a_{ij}}(1 - 0.1)^{a_{ij}}  \\ & \times  \prod\limits_{i=1}^{n} \left[ (0.6)^{z_{i}} ( 1 -  0.6)^{1 - z_{i}} I(x_{i} = 0) +  (0.4)^{z_{i}} \big( 1 -  0.4  \big)^{1 - z_{i}} I(x_{i} = 1) \right] \prod\limits_{i=1}^{n} 0.5^{x_{i}} (1-0.5)^{1 - x_{i}}   \end{align}$$

Now let $q_{12} < p_{2} < p_{1}$.


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two5_power1.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two5_power10.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/two5_power20.png")
```


```{r echo = FALSE, results='asis'}
a <- c(0.50, 0.54, 0.56)
b <- c(0.54, 0.58, 0.60)

table <- matrix(0, nrow = 2, ncol = 3)
rownames(table) <- c("global test", "local optimal")
colnames(table) <- c("t=1",  "t=5", "t=20")
table[1,] <- a
table[2,] <- b
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center'}
knitr::include_graphics("../figure/two5_plot.png")
```


### [sim] two.6
<a name=" two.6"/>

$K = 2$; $n_{1} = n_{2} = 50$ ; $n = n_{1} + n_{2} = 100.$

```{r echo = FALSE, results='asis'}
a <- c(0.5, 0.1, 0.5, 0.1, 0.3)

table <- matrix(0, nrow = 1, ncol = 5)
colnames(table) <- c("u", "w" , "p1", "p2", "q12")
table[1,] <- a
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


$$\begin{align} P_{\theta}(A, X, Z) & = P_{\phi}(A | Z) P_{\omega}(Z | X) P_{u}(X) \\ & = \prod\limits_{Z_{i} = Z_{j} = 0} 0.5^{a_{ij}}(1-0.5)^{a_{ij}} \prod\limits_{Z_{i} = Z_{j} = 1} 0.1^{a_{ij}}(1-0.1)^{a_{ij}} \prod\limits_{Z_{i} \neq Z_{j}} 0.3^{a_{ij}}(1 - 0.3)^{a_{ij}}  \\ & \times  \prod\limits_{i=1}^{n} \left[ (0.6)^{z_{i}} ( 1 -  0.6)^{1 - z_{i}} I(x_{i} = 0) +  (0.4)^{z_{i}} \big( 1 -  0.4  \big)^{1 - z_{i}} I(x_{i} = 1) \right] \prod\limits_{i=1}^{n} 0.5^{x_{i}} (1-0.5)^{1 - x_{i}}   \end{align}$$

Now let $p_{2} < q_{12} < p_{1}$.


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two6_power1.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold', out.extra='style="float:left"'}
knitr::include_graphics("../figure/two6_power10.png")
```
```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center', fig.show='hold'}
knitr::include_graphics("../figure/two6_power20.png")
```


```{r echo = FALSE, results='asis'}
a <- c(0.23, 0.14, 0.05)
b <- c(0.37, 0.25, 0.12)

table <- matrix(0, nrow = 2, ncol = 3)
rownames(table) <- c("global test", "local optimal")
colnames(table) <- c("t=1",  "t=5", "t=20")
table[1,] <- a
table[2,] <- b
table <- as.data.frame(table)
kable(table, align = 'c', digits = 2)
```


```{r, out.width = 300, out.height = 400, echo = FALSE, fig.align='center'}
knitr::include_graphics("../figure/two6_plot.png")
```